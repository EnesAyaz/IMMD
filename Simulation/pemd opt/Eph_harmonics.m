dataa = [
0,-55.541658
1,-54.032592
2,-52.573381
3,-51.109713
4,-49.585998
5,-47.93972
6,-46.095508
7,-43.959467
8,-41.415963
9,-38.332061
10,-34.577723
11,-30.067838
12,-24.816593
13,-18.967108
14,-12.751736
15,-6.38952
16,0
17,6.38952
18,12.751736
19,18.967108
20,24.816593
21,30.067838
22,34.577723
23,38.332061
24,41.415963
25,43.959467
26,46.095508
27,47.93972
28,49.585998
29,51.109713
30,52.573381
31,54.032592
32,55.541658
33,57.159317
34,58.955079
35,61.016772
36,63.45932
37,66.433253
38,70.128015
39,74.759247
40,80.523306
41,87.506492
42,95.568067
43,104.272823
44,112.96738
45,120.998139
46,127.929214
47,133.618707
48,138.151227
49,141.720828
50,144.540128
51,146.794663
52,148.629947
53,150.154444
54,151.447596
55,152.567881
56,153.559296
57,154.456121
58,155.286327
59,156.07406
60,156.84158
61,157.610961
62,158.40585
63,159.253521
64,160.187522
65,161.2511
66,162.501377
67,164.013462
68,165.882028
69,168.214894
70,171.110256
71,174.611277
72,178.647577
73,183.001513
74,187.346314
75,191.35505
76,194.809594
77,197.637087
78,199.881145
79,201.638361
80,203.014511
81,204.10171
82,204.971919
83,205.678409
84,206.259729
85,206.743697
86,207.150571
87,207.495349
88,207.789353
89,208.041299
90,208.258023
91,208.444973
92,208.606548
93,208.746338
94,208.867299
95,208.971877
96,209.062108
97,209.139689
98,209.206036
99,209.262326
100,209.309537
101,209.34847
102,209.379774
103,209.403965
104,209.421433
105,209.432459
106,209.437215
107,209.432459
108,209.421433
109,209.403965
110,209.379774
111,209.34847
112,209.309537
113,209.262326
114,209.206036
115,209.139689
116,209.062108
117,208.971877
118,208.867299
119,208.746338
120,208.606548
121,208.444973
122,208.258023
123,208.041299
124,207.789353
125,207.495349
126,207.150571
127,206.743697
128,206.259729
129,205.678409
130,204.971919
131,204.10171
132,203.014511
133,201.638361
134,199.881145
135,197.637087
136,194.809594
137,191.35505
138,187.346314
139,183.001513
140,178.647577
141,174.611277
142,171.110256
143,168.214894
144,165.882028
145,164.013462
146,162.501377
147,161.2511
148,160.187522
149,159.253521
150,158.40585
151,157.610961
152,156.84158
153,156.07406
154,155.286327
155,154.456121
156,153.559296
157,152.567881
158,151.447596
159,150.154444
160,148.629947
161,146.794663
162,144.540128
163,141.720828
164,138.151227
165,133.618707
166,127.929214
167,120.998139
168,112.96738
169,104.272823
170,95.568067
171,87.506492
172,80.523306
173,74.759247
174,70.128015
175,66.433253
176,63.45932
177,61.016772
178,58.955079
179,57.159317
180,55.541658
181,54.032592
182,52.573381
183,51.109713
184,49.585998
185,47.93972
186,46.095508
187,43.959467
188,41.415963
189,38.332061
190,34.577723
191,30.067838
192,24.816593
193,18.967108
194,12.751736
195,6.38952
196,0
197,-6.38952
198,-12.751736
199,-18.967108
200,-24.816593
201,-30.067838
202,-34.577723
203,-38.332061
204,-41.415963
205,-43.959467
206,-46.095508
207,-47.93972
208,-49.585998
209,-51.109713
210,-52.573381
211,-54.032592
212,-55.541658
213,-57.159317
214,-58.955079
215,-61.016772
216,-63.45932
217,-66.433253
218,-70.128015
219,-74.759247
220,-80.523306
221,-87.506492
222,-95.568067
223,-104.272823
224,-112.96738
225,-120.998139
226,-127.929214
227,-133.618707
228,-138.151227
229,-141.720828
230,-144.540128
231,-146.794663
232,-148.629947
233,-150.154444
234,-151.447596
235,-152.567881
236,-153.559296
237,-154.456121
238,-155.286327
239,-156.07406
240,-156.84158
241,-157.610961
242,-158.40585
243,-159.253521
244,-160.187522
245,-161.2511
246,-162.501377
247,-164.013462
248,-165.882028
249,-168.214894
250,-171.110256
251,-174.611277
252,-178.647577
253,-183.001513
254,-187.346314
255,-191.35505
256,-194.809594
257,-197.637087
258,-199.881145
259,-201.638361
260,-203.014511
261,-204.10171
262,-204.971919
263,-205.678409
264,-206.259729
265,-206.743697
266,-207.150571
267,-207.495349
268,-207.789353
269,-208.041299
270,-208.258023
271,-208.444973
272,-208.606548
273,-208.746338
274,-208.867299
275,-208.971877
276,-209.062108
277,-209.139689
278,-209.206036
279,-209.262326
280,-209.309537
281,-209.34847
282,-209.379774
283,-209.403965
284,-209.421433
285,-209.432459
286,-209.437215
287,-209.432459
288,-209.421433
289,-209.403965
290,-209.379774
291,-209.34847
292,-209.309537
293,-209.262326
294,-209.206036
295,-209.139689
296,-209.062108
297,-208.971877
298,-208.867299
299,-208.746338
300,-208.606548
301,-208.444973
302,-208.258023
303,-208.041299
304,-207.789353
305,-207.495349
306,-207.150571
307,-206.743697
308,-206.259729
309,-205.678409
310,-204.971919
311,-204.10171
312,-203.014511
313,-201.638361
314,-199.881145
315,-197.637087
316,-194.809594
317,-191.35505
318,-187.346314
319,-183.001513
320,-178.647577
321,-174.611277
322,-171.110256
323,-168.214894
324,-165.882028
325,-164.013462
326,-162.501377
327,-161.2511
328,-160.187522
329,-159.253521
330,-158.40585
331,-157.610961
332,-156.84158
333,-156.07406
334,-155.286327
335,-154.456121
336,-153.559296
337,-152.567881
338,-151.447596
339,-150.154444
340,-148.629947
341,-146.794663
342,-144.540128
343,-141.720828
344,-138.151227
345,-133.618707
346,-127.929214
347,-120.998139
348,-112.96738
349,-104.272823
350,-95.568067
351,-87.506492
352,-80.523306
353,-74.759247
354,-70.128015
355,-66.433253
356,-63.45932
357,-61.016772
358,-58.955079
359,-57.159317
360,-55.541658
    ];

elect_angle = dataa(:,1);
indvphase = dataa(:,2);

%%
Num = numel(elect_angle)-1;
a0_int = 0;
% fundamental & harmonics
a_int = zeros(1,31);
b_int = zeros(1,31);
% function
func = indvphase;
for k = 1:Num
    radang = (k-1)*pi/(Num/2);
    a0_int = a0_int+func(k);
    for l = 1:numel(a_int)
        a_int(1,l) = a_int(1,l)+func(k)*cos(l*radang);
        b_int(1,l) = b_int(1,l)+func(k)*sin(l*radang);
    end
end

fprintf('\nList of harmonis:\n');
dcval = a0_int/(Num);
fprintf('DC:%g\n',dcval);
for l = 1:numel(a_int)
    a = 2*a_int(l)/(Num);
    b = 2*b_int(l)/(Num);
    peak_magn(l) = sqrt(a.^2+b.^2);
    fprintf('%gth:%g\n',l,peak_magn(l));
end

% a0 = a0_int/(Num);
% a = 2*a_int/(Num);
% b = 2*b_int/(Num);
%
% peak_magn = sqrt(a1^2+b1^2);
% rms_magn = peak_magn/sqrt(2);
% one_module = rms_magn/4;

figure;
subplot(2,1,1)
plot(elect_angle,func,'b- ','Linewidth',1.5)
grid on;
set(gca,'FontSize',12);
xlabel('Electrical degrees','FontSize',8,'FontWeight','Bold');
ylabel('Phase induced voltage','FontSize',8,'FontWeight','Bold');
harm = 0:31;
harmvals(1) = dcval;
harmvals(2:length(harm)) = peak_magn(:);
subplot(2,1,2)
plot(harm,harmvals,'b-o','Linewidth',1.5)
grid on;
set(gca,'FontSize',12);
xlabel('Harmonic order','FontSize',8,'FontWeight','Bold');
ylabel('Value (peak)','FontSize',8,'FontWeight','Bold');

%%
harm2 = 1:31;
Ephmha = peak_magn'/(2*sqrt(2));

figure
plot(harm2,Ephmh,'b-o','Linewidth',1.5)
hold on;
plot(harm2,Ephmha,'r-o','Linewidth',1.5)
grid on;
set(gca,'FontSize',12);
xlabel('Harmonic order','FontSize',8,'FontWeight','Bold');
ylabel('Value (peak)','FontSize',8,'FontWeight','Bold');
