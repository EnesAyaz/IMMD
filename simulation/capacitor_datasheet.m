%% Aluminium Electrolytic Capacitors (EPCOS)
% Snap-in capacitors
% Series/Type:  
% Date: March 2016
% https://en.tdk.eu/designtools/alu_useful_life/Useful_life.swf

% columns:
% 1. capacitance (uF)
% 2. diameter (mm)
% 3. length (mm)
% 4. ESRtyp-100Hz-20C (mOhm)
% 5. ESRtyp-300Hz-60C (mOhm)
% 6. Zmax-10kHz-20C (mOhm)
% 7. Iacmax-100Hz-60C (A)
% 8. Iacr-100Hz-85C (A)

aec_200v = [
330 22 25 290 100 440 2.71 2.01 1.10
390 22 30 250 80 370 3.08 2.29 1.25
470 22 30 210 70 310 3.54 2.62 1.42
470 25 25 220 80 330 3.31 2.46 1.34
560 22 35 170 60 260 4.07 3.01 1.64
560 25 30 180 65 270 3.80 2.82 1.54
680 22 40 140 50 220 4.75 3.51 1.91
680 25 35 150 50 220 4.42 3.28 1.79
680 30 25 170 75 260 3.87 2.88 1.56
820 22 45 120 40 180 5.53 4.09 2.22
820 25 40 120 45 190 5.11 3.80 2.07
820 30 30 130 55 210 4.51 3.36 1.83
1000 25 45 100 36 160 5.97 4.43 2.41
1000 30 35 110 45 170 5.23 3.90 2.12
1000 35 25 140 80 220 4.33 3.22 1.74
1200 25 50 85 32 130 6.89 5.10 2.77
1200 30 35 100 45 160 5.74 4.27 2.31
1200 35 30 110 60 170 5.09 3.80 2.19
1500 30 45 75 34 120 7.03 5.23 3.02
1500 35 35 90 50 140 5.95 4.44 2.56
1800 30 50 65 30 100 8.02 5.96 3.43
1800 35 40 75 40 120 6.80 5.07 2.92
2200 30 55 55 26 85 9.24 6.86 3.94
2200 35 45 60 36 100 7.76 5.79 3.33
2700 35 50 55 32 85 8.86 6.59 3.78
];

aec_250v = [
220 22 25 350 110 500 2.25 1.68 0.91
270 22 30 290 90 400 2.63 1.96 1.07
330 22 30 240 80 340 3.07 2.28 1.24
330 25 25 250 90 350 2.91 2.17 1.18
390 22 35 200 65 290 3.50 2.60 1.41
390 25 30 210 70 290 3.31 2.47 1.34
470 22 40 170 55 240 4.07 3.02 1.64
470 25 30 180 65 250 3.78 2.80 1.52
470 30 25 190 80 270 3.47 2.59 1.40
560 22 45 140 45 200 4.70 3.48 1.89
560 25 35 150 55 210 4.33 3.22 1.74
560 30 30 150 60 220 3.99 2.98 1.62
680 22 50 120 40 170 5.51 4.08 2.21
680 25 40 120 45 180 5.05 3.75 2.03
680 30 30 130 60 200 4.44 3.31 1.79
680 35 25 150 80 230 4.00 2.99 1.61
820 25 45 100 40 150 5.87 4.35 2.35
820 30 35 110 50 170 5.13 3.82 2.07
820 35 30 120 60 180 4.68 3.50 2.02
1000 25 55 80 30 120 6.95 5.16 2.79
1000 30 40 90 40 140 5.96 4.44 2.56
1000 35 30 110 65 170 5.04 3.76 2.16
1200 30 45 75 36 120 6.85 5.09 2.93
1200 35 35 90 50 140 5.82 4.34 2.49
1500 30 55 60 28 95 8.24 6.13 3.53
1500 35 40 75 45 120 6.78 5.05 2.89
1800 35 50 60 32 90 8.06 6.02 3.46
2200 35 55 50 30 80 9.21 6.85 3.93
];

aec_400v = [
100 22 25 870 230 1250 1.62 1.20 0.65
120 22 30 730 190 1040 1.85 1.38 0.75
120 25 25 730 200 1050 1.81 1.35 0.73
150 22 30 620 150 900 2.19 1.63 0.88
150 25 25 630 160 920 2.12 1.58 0.85
180 22 35 520 130 750 2.52 1.88 1.01
180 25 30 490 140 710 2.47 1.83 0.99
180 30 25 500 150 730 2.39 1.78 0.97
220 22 40 420 100 620 2.97 2.22 1.19
220 25 35 400 110 580 2.88 2.14 1.16
220 30 25 440 120 650 2.70 2.01 1.08
270 22 50 320 90 470 3.60 2.66 1.44
270 25 40 330 90 480 3.40 2.52 1.37
270 30 30 340 110 500 3.19 2.37 1.28
270 35 25 350 120 520 3.05 2.27 1.23
330 25 45 290 75 420 3.91 2.92 1.57
330 30 35 280 85 410 3.71 2.75 1.49
330 35 25 320 110 480 3.38 2.52 1.36
390 25 50 240 60 360 4.51 3.36 1.81
390 30 35 250 75 380 4.11 3.07 1.65
390 35 30 250 90 370 3.91 2.90 1.67
470 30 45 200 60 290 4.89 3.63 2.09
470 35 35 210 75 310 4.49 3.34 1.92
560 30 50 170 55 240 5.63 4.18 2.41
560 35 40 170 60 260 5.13 3.81 2.20
680 30 55 140 45 220 6.42 4.78 2.75
680 35 45 140 55 220 5.92 4.40 2.53
820 35 50 130 45 190 6.69 4.99 2.86
];

aec_450v = [
68 22 25 1430 360 2140 1.26 0.94 0.51
82 22 25 1240 290 1900 1.46 1.09 0.59
100 22 30 970 250 1460 1.70 1.26 0.69
100 25 25 980 260 1470 1.67 1.24 0.67
120 22 35 810 210 1220 1.96 1.45 0.79
120 25 25 860 210 1300 1.91 1.43 0.77
150 22 40 650 170 980 2.35 1.74 0.95
150 25 30 680 170 1100 2.25 1.68 0.90
150 30 25 670 190 1010 2.20 1.63 0.89
180 22 45 540 140 810 2.74 2.02 1.10
180 25 35 550 150 820 2.62 1.94 1.05
180 30 25 590 160 890 2.49 1.86 1.00
220 22 50 460 110 700 3.22 2.40 1.29
220 25 40 470 110 710 3.04 2.27 1.22
220 30 30 460 130 700 2.90 2.15 1.17
220 35 25 470 150 720 2.80 2.08 1.13
270 25 45 380 95 580 3.61 2.69 1.44
270 30 35 370 110 570 3.38 2.51 1.36
270 35 30 380 120 580 3.25 2.41 1.40
330 25 55 310 75 470 4.26 3.18 1.71
330 30 40 310 90 470 3.97 2.94 1.70
330 35 30 330 100 520 3.66 2.73 1.57
390 30 45 270 70 410 4.47 3.34 1.92
390 35 35 270 90 420 4.21 3.12 1.80
470 30 50 220 60 350 5.21 3.88 2.23
470 35 40 230 75 350 4.84 3.59 2.07
560 35 45 200 60 310 5.46 4.08 2.34
680 35 55 160 50 240 6.47 4.81 2.77
];

aec_500v = [
39 22 25 2100 510 3100 0.82 0.82 0.39
47 22 30 1800 420 2500 0.99 0.93 0.44
56 22 30 1500 360 2100 1.18 1.04 0.49
56 25 25 1500 370 2200 1.18 1.07 0.50
68 22 35 1200 300 1800 1.43 1.20 0.57
68 25 30 1200 300 1800 1.43 1.22 0.57
82 22 40 1000 250 1500 1.73 1.37 0.65
82 25 30 1000 250 1500 1.73 1.37 0.64
82 30 25 1000 260 1500 1.73 1.43 0.67
100 22 45 840 200 1200 2.11 1.59 0.75
100 25 35 840 210 1200 2.11 1.58 0.74
100 30 30 850 210 1200 2.11 1.63 0.77
120 22 50 700 170 990 2.45 1.82 0.86
120 25 40 700 170 990 2.42 1.80 0.85
120 30 30 710 180 1100 2.44 1.81 0.85
120 35 25 720 200 1100 2.51 1.86 0.88
150 25 50 560 140 800 2.86 2.13 1.01
150 30 35 570 150 810 2.84 2.11 1.00
150 35 30 580 160 820 2.92 2.17 1.09
180 25 55 470 120 660 3.28 2.44 1.15
180 30 40 470 120 680 3.23 2.40 1.21
180 35 35 480 130 690 3.31 2.46 1.24
220 30 50 390 100 550 3.75 2.79 1.41
220 35 35 400 110 570 3.68 2.73 1.37
270 30 55 320 80 450 4.33 3.22 1.62
270 35 45 320 90 460 4.31 3.20 1.61
330 35 50 260 75 380 4.92 3.65 1.84
390 35 55 220 65 330 5.51 4.09 2.06
];

%%

% Use 500V and 450V capacitors as one series
% USe 400V and 250V capacitors as two series
% Parallel connection will be decided by RMS current requirement

cap_select = 1:numel(aec_500v(:,1));

figure;
plot(cap_select,aec_500v(:,7),'bo-','Linewidth',1.5);
hold on;
plot(cap_select,aec_450v(:,7),'ro-','Linewidth',1.5);
hold on;
plot(cap_select,aec_400v(:,7),'mo-','Linewidth',1.5);
hold on;
plot(cap_select,aec_250v(:,7),'go-','Linewidth',1.5);
hold off;
grid on;
set(gca,'FontSize',12);
xlabel('Capacitor No','FontSize',12,'FontWeight','Bold')
ylabel('Ripple Current - max - 60 C - 100 Hz (A)','FontSize',12,'FontWeight','Bold')
legend('500V series','450V series','400V series','250V series')


%%
% Plot of capacitance vs RMs current

figure;
plot(aec_500v(:,1),aec_500v(:,7),'bo ','Linewidth',1.5);
hold on;
plot(aec_450v(:,1),aec_450v(:,7),'ro ','Linewidth',1.5);
hold on;
plot(aec_400v(:,1)/2,aec_400v(:,7),'ko ','Linewidth',1.5);
hold on;
plot(aec_250v(:,1)/2,aec_250v(:,7),'mo ','Linewidth',1.5);
hold on;
grid on;
set(gca,'FontSize',12);
xlabel('Capacitance','FontSize',12,'FontWeight','Bold')
ylabel('Ripple Current - max - 60 C - 100 Hz (A)','FontSize',12,'FontWeight','Bold')
legend('500V series','450V series','400V series','250V series')


%% Film Capacitors (EPCOS)
% Metallized Polypropylene Film Capacitors (MKP)
% Series/Type: B32674 ... B32678
% Date: June 2015

% VR,85 °C = 300 V DC, Vop,70 °C = 450 V DC
% VR,85 °C = 450 V DC, Vop,70 °C = 630 V DC

% columns:
% 1. capacitance (uF)
% 2. width (mm)
% 3. height (mm)
% 4. length (mm)
% 5. Iacmax-10kHz-70C (A)
% 6. ESRtyp-10kHz-70C (mOhm)
% 7. ESL (nH)
% 8. tandelta-1kHz (1e-3)
% 9. tandelta-10kHz (1e-3)
% 10. MOQ

fpc_300v1 = [
2.2 11.0 19.0 31.5 5.0 18.1 16.0 0.7 4.1 1280
3.3 12.5 21.5 31.5 7.0 12.2 19.0 0.7 4.1 1120
4.7 14.0 24.5 31.5 8.5 8.9 21.0 0.7 4.2 1040
5.0 15.0 24.5 31.5 9.0 8.4 21.0 0.7 4.2 960
6.8 18.0 27.5 31.5 11.5 6.3 24.0 0.7 4.4 800
8.0 16.0 32.0 31.5 12.5 5.6 27.0 0.7 4.5 880
8.2 18.0 33.0 31.5 13.0 5.5 27.0 0.7 4.5 800
10.0 21.0 31.0 31.5 14.5 4.6 27.0 0.8 4.6 720
12.0 22.0 36.5 31.5 17.0 4.0 31.0 0.8 4.9 640
];

fpc_450v1 = [
1.5 11.0 19.0 31.5 4.5 22.1 16.0 0.6 3.3 1280
2.2 12.5 21.5 31.5 6.0 14.9 19.0 0.6 3.3 1120
3.3 15.0 24.5 31.5 8.0 10.3 22.0 0.6 3.4 960
4.7 18.0 27.5 31.5 10.5 7.5 24.0 0.6 3.5 800
5.0 16.0 32.0 31.5 11.0 7.1 28.0 0.7 3.6 880
5.6 18.0 33.0 31.5 12.0 6.3 29.0 0.7 3.6 800
6.0 21.0 31.0 31.5 13.0 5.9 28.0 0.7 3.6 720
6.8 22.0 36.5 31.5 14.5 5.4 29.0 0.7 3.7 640
7.5 22.0 36.5 31.5 15.0 5.0 32.0 0.7 3.8 640
];

fpc_300v2 = [
6.2 24.0 15.0 41.5 8.0 12.6 18.0 1.1 8.2 1040
9.0 24.0 19.0 41.5 10.0 9.1 19.0 1.1 8.3 780
15.0 20.0 39.5 42.0 16.0 5.4 10.0 1.1 8.3 640
20.0 28.0 37.0 42.0 20.0 4.0 11.0 1.1 8.4 440
20.0 43.0 22.0 41.5 19.5 4.0 13.0 1.1 8.3 280
22.0 28.0 42.5 42.0 21.5 3.8 11.0 1.2 8.5 440
25.0 28.0 42.5 42.0 22.5 3.4 12.0 1.2 8.6 440
30.0 30.0 45.0 42.0 26.0 2.8 12.0 1.2 8.7 400
35.0 33.0 48.0 42.0 29.5 2.5 13.0 1.2 8.8 180
];

fpc_450v2 = [
4.0 24.0 15.0 41.5 7.0 15.5 19.0 1.0 6.6 1040
4.7 24.0 19.0 41.5 8.0 13.2 18.0 1.0 6.6 780
8.2 20.0 39.5 42.0 13.5 7.8 9.0 1.0 6.7 640
10.0 20.0 39.5 42.0 14.5 6.4 11.0 1.0 6.7 640
13.0 43.0 22.0 41.5 17.5 5.0 13.0 1.0 6.6 280
15.0 28.0 42.5 42.0 20.0 4.4 11.0 1.0 6.8 440
20.0 30.0 45.0 42.0 24.0 3.3 13.0 1.0 6.9 400
25.0 33.0 48.0 42.0 28.0 2.8 14.0 1.0 7.1 180
];

fpc_300v3 = [
30.0 43.0 24.0 57.5 22.5 3.9 13.0 1.5 11.8 420
40.0 30.0 45.0 57.5 28.0 3.0 12.0 1.5 12.3 280
47.0 35.0 50.0 57.5 33.0 2.6 13.0 1.5 12.5 108
60.0 35.0 50.0 57.5 37.0 2.1 15.0 1.6 12.9 108
80.0 45.0 57.0 57.5 47.0 1.6 18.0 1.6 13.5 140
80.0 130.0 24.0 57.5 51.0 1.4 4.0 1.5 11.7 80
100.0 60.0 45.0 57.5 48.0 1.4 19.0 1.6 13.5 200
270.0 130.0 58.0 57.5 108.0 0.5 6.0 1.6 13.8 40
];

fpc_450v3 = [
20.0 43.0 24.0 57.5 20.0 4.9 13.0 1.3 9.8 420
30.0 35.0 50.0 57.5 28.0 3.2 14.0 1.3 9.9 108
35.0 35.0 50.0 57.5 31.5 2.8 14.0 1.3 10.0 108
40.0 35.0 50.0 57.5 34.0 2.5 15.0 1.3 10.2 108
60.0 45.0 57.0 57.5 45.0 1.8 18.0 1.4 11.2 140
60.0 130.0 24.0 57.5 49.5 1.6 4.0 1.2 9.5 80
65.0 60.0 45.0 57.5 48.0 1.6 19.0 1.3 10.6 200
180.0 130.0 58.0 57.5 97.5 0.6 6.0 1.4 11.2 40
];

fpc_300v = [
2.2 11.0 19.0 31.5 5.0 18.1 16.0 0.7 4.1 1280 25 27.5
3.3 12.5 21.5 31.5 7.0 12.2 19.0 0.7 4.1 1120 30 27.5
4.7 14.0 24.5 31.5 8.5 8.9 21.0 0.7 4.2 1040 35 27.5
5.0 15.0 24.5 31.5 9.0 8.4 21.0 0.7 4.2 960 36 27.5
6.8 18.0 27.5 31.5 11.5 6.3 24.0 0.7 4.4 800 44 27.5
8.0 16.0 32.0 31.5 12.5 5.6 27.0 0.7 4.5 880 45 27.5
8.2 18.0 33.0 31.5 13.0 5.5 27.0 0.7 4.5 800 48 27.5
10.0 21.0 31.0 31.5 14.5 4.6 27.0 0.8 4.6 720 51 27.5
12.0 22.0 36.5 31.5 17.0 4.0 31.0 0.8 4.9 640 58 27.5
6.2 24.0 15.0 41.5 8.0 12.6 18.0 1.1 8.2 1040 44 37.5
9.0 24.0 19.0 41.5 10.0 9.1 19.0 1.1 8.3 780 50 37.5
15.0 20.0 39.5 42.0 16.0 5.4 10.0 1.1 8.3 640 72 37.5
20.0 28.0 37.0 42.0 20.0 4.0 11.0 1.1 8.4 440 83 37.5
20.0 43.0 22.0 41.5 19.5 4.0 13.0 1.1 8.3 280 80 37.5
22.0 28.0 42.5 42.0 21.5 3.8 11.0 1.2 8.5 440 90 37.5
25.0 28.0 42.5 42.0 22.5 3.4 12.0 1.2 8.6 440 90 37.5
30.0 30.0 45.0 42.0 26.0 2.8 12.0 1.2 8.7 400 100 37.5
35.0 33.0 48.0 42.0 29.5 2.5 13.0 1.2 8.8 180 110 37.5
30.0 43.0 24.0 57.5 22.5 3.9 13.0 1.5 11.8 420 103 52.5
40.0 30.0 45.0 57.5 28.0 3.0 12.0 1.5 12.3 280 125 52.5
47.0 35.0 50.0 57.5 33.0 2.6 13.0 1.5 12.5 108 145 52.5
60.0 35.0 50.0 57.5 37.0 2.1 15.0 1.6 12.9 108 145 52.5
80.0 45.0 57.0 57.5 47.0 1.6 18.0 1.6 13.5 140 185 52.5
80.0 130.0 24.0 57.5 51.0 1.4 4.0 1.5 11.7 80 200 52.5
100.0 60.0 45.0 57.5 48.0 1.4 19.0 1.6 13.5 200 192 52.5
270.0 130.0 58.0 57.5 108.0 0.5 6.0 1.6 13.8 40 300 52.5
];

% 1 dummy capacitor is added
fpc_450v = [
1.5 11.0 19.0 31.5 4.5 22.1 16.0 0.6 3.3 1280 25 27.5
1.5 11.0 19.0 31.5 4.5 22.1 16.0 0.6 3.3 1280 25 27.5
2.2 12.5 21.5 31.5 6.0 14.9 19.0 0.6 3.3 1120 30 27.5
3.3 15.0 24.5 31.5 8.0 10.3 22.0 0.6 3.4 960 36 27.5
4.7 18.0 27.5 31.5 10.5 7.5 24.0 0.6 3.5 800 44 27.5
5.0 16.0 32.0 31.5 11.0 7.1 28.0 0.7 3.6 880 45 27.5
5.6 18.0 33.0 31.5 12.0 6.3 29.0 0.7 3.6 800 48 27.5
6.0 21.0 31.0 31.5 13.0 5.9 28.0 0.7 3.6 720 51 27.5
6.8 22.0 36.5 31.5 14.5 5.4 29.0 0.7 3.7 640 58 27.5
7.5 22.0 36.5 31.5 15.0 5.0 32.0 0.7 3.8 640 58 27.5
4.0 24.0 15.0 41.5 7.0 15.5 19.0 1.0 6.6 1040 44 37.5
4.7 24.0 19.0 41.5 8.0 13.2 18.0 1.0 6.6 780 50 37.5
8.2 20.0 39.5 42.0 13.5 7.8 9.0 1.0 6.7 640 72 37.5
10.0 20.0 39.5 42.0 14.5 6.4 11.0 1.0 6.7 640 72 37.5
13.0 43.0 22.0 41.5 17.5 5.0 13.0 1.0 6.6 280 80 37.5
15.0 28.0 42.5 42.0 20.0 4.4 11.0 1.0 6.8 440 90 37.5
20.0 30.0 45.0 42.0 24.0 3.3 13.0 1.0 6.9 400 100 37.5
25.0 33.0 48.0 42.0 28.0 2.8 14.0 1.0 7.1 180 110 37.5
20.0 43.0 24.0 57.5 20.0 4.9 13.0 1.3 9.8 420 103 52.5
30.0 35.0 50.0 57.5 28.0 3.2 14.0 1.3 9.9 108 145 52.5
35.0 35.0 50.0 57.5 31.5 2.8 14.0 1.3 10.0 108 145 52.5
40.0 35.0 50.0 57.5 34.0 2.5 15.0 1.3 10.2 108 145 52.5
60.0 45.0 57.0 57.5 45.0 1.8 18.0 1.4 11.2 140 185 52.5
60.0 130.0 24.0 57.5 49.5 1.6 4.0 1.2 9.5 80 200 52.5
65.0 60.0 45.0 57.5 48.0 1.6 19.0 1.3 10.6 200 192 52.5
180.0 130.0 58.0 57.5 97.5 0.6 6.0 1.4 11.2 40 300 52.5
];


%%
cap_select = 1:numel(fpc_300v(:,1));

figure;
plot(cap_select,fpc_450v(:,5),'bo-','Linewidth',1.5);
hold on;
plot(cap_select,fpc_300v(:,5),'ro-','Linewidth',1.5);
hold off;
grid on;
set(gca,'FontSize',12);
xlabel('Capacitor No','FontSize',12,'FontWeight','Bold')
ylabel('Ripple Current - max - 70 C - 10 kHz (A)','FontSize',12,'FontWeight','Bold')
legend('450V series','300V series')

figure;
plot(cap_select,fpc_450v(:,1),'bo-','Linewidth',1.5);
hold on;
plot(cap_select,fpc_300v(:,1)/2,'ro-','Linewidth',1.5);
hold off;
grid on;
set(gca,'FontSize',12);
xlabel('Capacitor No','FontSize',12,'FontWeight','Bold')
ylabel('Capacitance','FontSize',12,'FontWeight','Bold')
legend('450V series','300V series')


%%

% Use 450V capacitors as one series
% USe 300V capacitors as two series
% Parallel connection will be decided by RMS current requirement

cap_select = 1:numel(fpc_300v(:,1));

figure;
plot(fpc_450v(1:20,1),fpc_450v(1:20,5),'bo-','Linewidth',1.5);
hold on;
plot(fpc_300v(1:20,1)/2,fpc_300v(1:20,5),'ro-','Linewidth',1.5);
hold off;
grid on;
set(gca,'FontSize',12);
xlabel('Capacitance','FontSize',12,'FontWeight','Bold')
ylabel('Ripple Current - max - 70 C - 10 kHz (A)','FontSize',12,'FontWeight','Bold')
legend('450V series','300V series')


